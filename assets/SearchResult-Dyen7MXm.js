import{u as G,h as le,k as te,l as U,m as ae,P as se,n as re,p as ie,j as S,q as C,s as oe,v as M,i as t,x as ue,R as T,y as ne,z as ce,A as Ee,C as ve,B as he,D as pe,E as de,G as ye,H as me,I as H,J as Ae,K as ge,L as Be,M as $,N as j,O as fe}from"./app-TChdOyIt.js";const be=["/","/intro.html","/blog/","/blog/about.html","/demo/1.learn_temp.html","/demo/2.blog_temp.html","/demo/3.readme_temp.html","/demo/","/demo/disable.html","/demo/encrypt.html","/demo/layout.html","/demo/markdown.html","/demo/page.html","/learn/","/blog/life/","/blog/notes/","/blog/other/","/learn/code/","/learn/play/","/learn/system/","/blog/life/article/","/blog/life/article/hello-wrold.html","/blog/life/article/%E5%89%81%E6%89%8B.html","/blog/life/article/%E5%A3%AC%E5%AF%85%E5%B9%B4%E5%AF%84%E7%99%B8%E5%8D%AF%E5%B9%B4%E6%91%86.html","/blog/life/article/%E6%96%B0%E5%B9%B4%E7%AC%AC%E4%B8%80%E7%AF%87.html","/blog/life/article/%E6%97%A5%E8%AE%B0_20240906.html","/blog/notes/article/","/blog/notes/article/%E6%B8%B4%E6%9C%9B%E5%8F%88%E4%B8%8D%E5%8F%AF%E5%8F%8A.html","/blog/notes/article/%E9%97%B2%E8%A8%80%E6%9D%82%E5%8F%99.html","/blog/other/article/","/blog/other/article/%E5%B0%8F%E8%AF%B4_%E7%AC%AC%E4%B8%80%E7%AB%A0.html","/blog/other/article/%E8%BF%AB%E4%BA%8EGridea%E6%97%A0%E6%B3%95%E5%90%8C%E6%AD%A5.html","/learn/code/Git/","/learn/code/Git/%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E5%8F%91%E5%B8%83pages.html","/learn/play/nas/Alist_%E6%9C%8D%E5%8A%A1%E8%B0%83%E6%95%B4.html","/learn/play/nas/Frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F.html","/learn/play/nas/","/learn/play/nas/TrueNAS%E4%BA%91%E5%90%8C%E6%AD%A5.html","/learn/play/nas/%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%A0%B8%E6%98%BE%E7%9B%B4%E9%80%9A.html","/learn/system/linux/Linux%E4%B8%8B%E9%94%AE%E7%9B%98%E5%8A%9F%E8%83%BD%E9%94%AE%E6%A8%A1%E5%BC%8F%E6%98%A0%E5%B0%84%E8%AE%BE%E7%BD%AE.html","/learn/system/linux/","/404.html","/category/","/category/%E8%AE%B0%E5%BD%95/","/category/%E8%B4%AD%E7%89%A9/","/category/%E6%80%BB%E7%BB%93/","/category/%E6%97%A5%E8%AE%B0/","/category/%E6%96%87%E7%AB%A0/","/category/%E5%AD%A6%E4%B9%A0/","/tag/","/tag/%E9%9A%8F%E7%AC%94/","/tag/%E5%A4%96%E8%AE%BE/","/tag/%E5%B0%8F%E8%AF%B4/","/tag/%E5%8A%A8%E6%89%8B%E5%AE%9E%E8%B7%B5/","/tag/git/","/tag/nas/","/tag/linux/","/article/","/star/","/timeline/"],Fe="SEARCH_PRO_QUERY_HISTORY",m=G(Fe,[]),Ce=()=>{const{queryHistoryCount:a}=H,s=a>0;return{enabled:s,queryHistory:m,addQueryHistory:r=>{s&&(m.value=Array.from(new Set([r,...m.value.slice(0,a-1)])))},removeQueryHistory:r=>{m.value=[...m.value.slice(0,r),...m.value.slice(r+1)]}}},L=a=>be[a.id]+("anchor"in a?`#${a.anchor}`:""),He="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:I}=H,A=G(He,[]),De=()=>{const a=I>0;return{enabled:a,resultHistory:A,addResultHistory:s=>{if(a){const r={link:L(s),display:s.display};"header"in s&&(r.header=s.header),A.value=[r,...A.value.slice(0,I-1)]}},removeResultHistory:s=>{A.value=[...A.value.slice(0,s),...A.value.slice(s+1)]}}},Re=a=>{const s=ve(),r=U(),D=he(),o=S(0),f=C(()=>o.value>0),p=pe([]);return de(()=>{const{search:d,terminate:R}=ye(),g=me(c=>{const B=c.join(" "),{searchFilter:k=h=>h,splitWord:x,suggestionsFilter:_,...y}=s.value;B?(o.value+=1,d(c.join(" "),r.value,y).then(h=>k(h,B,r.value,D.value)).then(h=>{o.value-=1,p.value=h}).catch(h=>{console.warn(h),o.value-=1,o.value||(p.value=[])})):p.value=[]},H.searchDelay-H.suggestDelay);M([a,r],([c])=>g(c),{immediate:!0}),Ae(()=>{R()})}),{isSearching:f,results:p}};var xe=le({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:s}){const r=te(),D=U(),o=ae(se),{enabled:f,addQueryHistory:p,queryHistory:d,removeQueryHistory:R}=Ce(),{enabled:g,resultHistory:c,addResultHistory:B,removeResultHistory:k}=De(),x=f||g,_=re(a,"queries"),{results:y,isSearching:h}=Re(_),i=ie({isQuery:!0,index:0}),E=S(0),v=S(0),O=C(()=>x&&(d.value.length>0||c.value.length>0)),w=C(()=>y.value.length>0),Q=C(()=>y.value[E.value]||null),Y=()=>{const{isQuery:e,index:l}=i;l===0?(i.isQuery=!e,i.index=e?c.value.length-1:d.value.length-1):i.index=l-1},N=()=>{const{isQuery:e,index:l}=i;l===(e?d.value.length-1:c.value.length-1)?(i.isQuery=!e,i.index=0):i.index=l+1},z=()=>{E.value=E.value>0?E.value-1:y.value.length-1,v.value=Q.value.contents.length-1},J=()=>{E.value=E.value<y.value.length-1?E.value+1:0,v.value=0},K=()=>{v.value<Q.value.contents.length-1?v.value+=1:J()},V=()=>{v.value>0?v.value-=1:z()},q=e=>e.map(l=>fe(l)?l:t(l[0],l[1])),W=e=>{if(e.type==="customField"){const l=ge[e.index]||"$content",[u,F=""]=Be(l)?l[D.value].split("$content"):l.split("$content");return e.display.map(n=>t("div",q([u,...n,F])))}return e.display.map(l=>t("div",q(l)))},b=()=>{E.value=0,v.value=0,s("updateQuery",""),s("close")},X=()=>f?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.queryHistory),d.value.map((e,l)=>t("div",{class:["search-pro-result-item",{active:i.isQuery&&i.index===l}],onClick:()=>{s("updateQuery",e)}},[t($,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:j,onClick:u=>{u.preventDefault(),u.stopPropagation(),R(l)}})]))])):null,Z=()=>g?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.resultHistory),c.value.map((e,l)=>t(T,{to:e.link,class:["search-pro-result-item",{active:!i.isQuery&&i.index===l}],onClick:()=>{b()}},()=>[t($,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(u=>q(u)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:j,onClick:u=>{u.preventDefault(),u.stopPropagation(),k(l)}})]))])):null;return oe("keydown",e=>{if(a.isFocusing){if(w.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const l=Q.value.contents[v.value];p(a.queries.join(" ")),B(l),r.push(L(l)),b()}}else if(g){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")N();else if(e.key==="Enter"){const{index:l}=i;i.isQuery?(s("updateQuery",d.value[l]),e.preventDefault()):(r.push(c.value[l].link),b())}}}}),M([E,v],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!w.value:!O.value}],id:"search-pro-results"},a.queries.length?h.value?t(ue,{hint:o.value.searching}):w.value?t("ul",{class:"search-pro-result-list"},y.value.map(({title:e,contents:l},u)=>{const F=E.value===u;return t("li",{class:["search-pro-result-list-item",{active:F}]},[t("div",{class:"search-pro-result-title"},e||o.value.defaultTitle),l.map((n,ee)=>{const P=F&&v.value===ee;return t(T,{to:L(n),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{p(a.queries.join(" ")),B(n),b()}},()=>[n.type==="text"?null:t(n.type==="title"?ne:n.type==="heading"?ce:Ee,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?t("div",{class:"content-header"},n.header):null,t("div",W(n))])])})])})):o.value.emptyResult:x?O.value?[X(),Z()]:o.value.emptyHistory:o.value.emptyResult)}});export{xe as default};
